<?xml version="1.0"?>

<!-- Search sub sitemap -->
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

  <!-- ========================= Components ============================== -->
  <map:components>
    <map:generators default="file">
      <map:generator name="search"
        src="org.apache.cocoon.generation.SearchGenerator"
        label="content"/>
    </map:generators>

    <map:transformers default="xslt">
      <map:transformer name="log"
        src="org.apache.cocoon.transformation.LogTransformer"/>
    </map:transformers>

    <map:readers default="resource"/>
    <map:serializers default="html"/>
    <map:matchers default="wildcard"/>
    <map:selectors default="browser"/>
    <map:actions/>
  </map:components>

  <!-- ========================== Views ================================== -->
  <map:views>
    <map:view name="content" from-label="content">
     <map:serialize type="xml"/>
    </map:view>

    <map:view name="links" from-position="last">
     <map:serialize type="links"/>
    </map:view>
  </map:views>

  <!-- ========================= Pipelines =============================== -->
  <map:pipelines>
    <map:pipeline>
      <map:match pattern="">
        <map:redirect-to uri="welcome"/>
      </map:match>

      <map:match pattern="images/*.gif">
        <map:read src="images/{1}.gif" mime-type="image/gif">
          <map:parameter name="expires" value="60000"/>
        </map:read>
      </map:match>

      <map:match pattern="findIt">
        <map:generate type="search"/>
        <map:transform type="log"/>
        <map:transform src="stylesheets/search2html.xsl"/>
        <map:serialize/>
      </map:match>
    
      <map:match pattern="**">
        <map:generate type="serverpages" src="{1}-index.xsp"/>
        <map:transform src="context://stylesheets/dynamic-page2html.xsl">
          <map:parameter name="view-source" value="search/{1}-index.xsp"/>
        </map:transform>
        <map:serialize/>
      </map:match>
    </map:pipeline>
  </map:pipelines>
</map:sitemap>
<!-- end of file -->
